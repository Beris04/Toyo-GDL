<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Toyo Foods ‚Äì Seguimiento de Visitas</title>

<style>
:root{
  --blue:#0046BE;
  --navy:#002E80;
  --bg:#F3F5F9;
  --card:#fff;
  --border:#d8dee9;
  --good:#16a34a;
  --warn:#f59e0b;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,Arial;
  background:var(--bg);
  padding:14px;
}
header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:14px;
}
.header-left{
  display:flex;
  align-items:center;
  gap:12px;
}
.header-left img{height:42px}
.brand h1{margin:0;font-size:18px;color:var(--navy)}
.brand .sub{font-size:12px;color:#555}
.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:14px;
  padding:14px;
  margin-bottom:12px;
}
h2{margin:0 0 10px;color:var(--blue);font-size:15px}
label{font-size:12px;color:#555}
input,select,textarea{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:1px solid var(--border);
  margin-bottom:8px;
}
textarea{min-height:70px}
button{
  background:var(--blue);
  color:#fff;
  border:none;
  border-radius:10px;
  padding:10px;
  cursor:pointer;
}
.kpi{margin-bottom:10px}
.bar{
  height:10px;
  background:#e5e7eb;
  border-radius:999px;
  overflow:hidden;
}
.bar div{
  height:100%;
  background:linear-gradient(90deg,var(--blue),#2563eb);
  width:0%;
}
table{
  width:100%;
  font-size:12px;
  border-collapse:collapse;
}
th,td{
  padding:6px;
  border-bottom:1px solid var(--border);
}
a{color:var(--blue);text-decoration:none}
</style>
</head>

<body>

<header>
  <div class="header-left">
    <img src="logo.png">
    <div class="brand">
      <h1>Toyo Foods</h1>
      <div class="sub">Seguimiento de Visitas</div>
    </div>
  </div>
  <div id="gpsStatus">üìç GPS‚Ä¶</div>
</header>

<div class="card">
<h2>Registrar visita</h2>

<label>Vendedor</label>
<select id="vendor">
  <option value="">Selecciona</option>
  <option>Aguilar Neri Daniel</option>
  <option>De la Cruz Ponce Julio Cesar</option>
  <option>Garibay Ortiz Sergio Joel</option>
  <option>Perez Mar Alan Roberto</option>
  <option>Reynoso Aguilar Maricela</option>
  <option>Sandra Navarro Navarro</option>
  <option>Arcenio Aguirre Ojeda</option>
  <option>Velez Castellanos Antonio</option>
  <option>Yepez Mora Oscar Alberto</option>
  <option>Beristain Bola√±os Hector</option>
  <option>Sierra de Anda Aldo</option>
</select>

<label>Cliente</label>
<input id="client">

<label>Motivo</label>
<select id="motive">
  <option value="">Selecciona</option>
  <option>Cotizaci√≥n</option>
  <option>Negociaci√≥n</option>
  <option>Degustaci√≥n</option>
  <option>Entrega de faltante</option>
</select>

<label>Comentarios</label>
<textarea id="comments"></textarea>

<button onclick="saveVisit()">Guardar visita</button>
</div>

<div class="card">
<h2>Meta mensual</h2>

<label>Meta ($)</label>
<input id="meta">

<label>Avance ($)</label>
<input id="avance">

<button onclick="saveMeta()">Guardar meta</button>
</div>

<div class="card">
<h2>Indicadores</h2>

<div class="kpi">Visitas hoy: <b id="todayCount">0</b></div>
<div class="bar"><div id="todayBar"></div></div>

<div class="kpi">Visitas semana: <b id="weekCount">0</b></div>
<div class="bar"><div id="weekBar"></div></div>

<div class="kpi">Meta mensual: <b id="metaPct">0%</b></div>
<div class="bar"><div id="metaBar"></div></div>
</div>

<div class="card">
<h2>Historial</h2>
<table>
<thead>
<tr><th>Fecha</th><th>Vendedor</th><th>Cliente</th><th>Mapa</th></tr>
</thead>
<tbody id="history"></tbody>
</table>
</div>

<script>
const visits = JSON.parse(localStorage.getItem("toyo_visits")||"[]");
const metaData = JSON.parse(localStorage.getItem("toyo_meta")||"{}");

function saveVisit(){
  if(!vendor.value || !client.value || !motive.value){
    alert("Completa todos los campos");
    return;
  }
  if(!navigator.geolocation){
    alert("GPS no disponible");
    return;
  }

  navigator.geolocation.getCurrentPosition(pos=>{
    visits.push({
      vendor:vendor.value,
      client:client.value,
      motive:motive.value,
      comments:comments.value,
      lat:pos.coords.latitude,
      lng:pos.coords.longitude,
      date:new Date().toISOString()
    });
    localStorage.setItem("toyo_visits",JSON.stringify(visits));
    render();
    alert("Visita guardada");
  },()=>{
    alert("Activa GPS");
  });
}

function saveMeta(){
  metaData.meta=Number(meta.value||0);
  metaData.avance=Number(avance.value||0);
  localStorage.setItem("toyo_meta",JSON.stringify(metaData));
  render();
}

function render(){
  history.innerHTML="";
  visits.forEach(v=>{
    history.innerHTML+=`
    <tr>
      <td>${v.date.slice(0,10)}</td>
      <td>${v.vendor}</td>
      <td>${v.client}</td>
      <td><a target="_blank" href="https://maps.google.com?q=${v.lat},${v.lng}">Mapa</a></td>
    </tr>`;
  });

  const today=new Date().toISOString().slice(0,10);
  const todayCount=visits.filter(v=>v.date.startsWith(today)).length;
  document.getElementById("todayCount").textContent=todayCount;
  document.getElementById("todayBar").style.width=Math.min(todayCount/5*100,100)+"%";

  document.getElementById("weekCount").textContent=visits.length;
  document.getElementById("weekBar").style.width=Math.min(visits.length/25*100,100)+"%";

  if(metaData.meta){
    const pct=Math.round(metaData.avance/metaData.meta*100);
    document.getElementById("metaPct").textContent=pct+"%";
    document.getElementById("metaBar").style.width=Math.min(pct,100)+"%";
  }
}

render();
</script>

</body>
</html>



